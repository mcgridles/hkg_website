{% extends "pages/base.html" %}
{% load mathfilters static %}

{% block stylesheets %}
  <link rel="stylesheet" type="text/css" href="{% static 'pages/css/details.css' %}?{% now "U" %}" />
{% endblock %}

{% block title %}{{ exppost.title }}{% endblock %}

{% block content %}
  <div id="top">
    <h1 class="heading">{{ exppost.title }}</h1>

    <p style="text-align:center;">
      {% if exppost.position %}
        <strong>{{ exppost.position }}</strong><br>
      {% endif %}

      {{ exppost.start_date|date:"F Y" }} -
      {% if exppost.end_date %}
        {{ exppost.end_date|date:"F Y" }}
      {% else %}
        Present
      {% endif %}
    </p>

    <p>{{ exppost.description|linebreaks }}</p>
  </div>

  <!-- Lightbox -->
  <div class="row">
    {% for image in exppost.image_set.all %}
      <img class="column"
           src="{{ image.img.url }}"
           alt="{{ image.title }}"
           style="width:{{ image.aspect_ratio|mul:256 }};height:256px"
           onclick="openModal();currentSlide({{ forloop.counter }})">
    {% endfor %}
  </div>

  <div id="myModal" class="modal">
    <span class="close cursor" onclick="closeModal()">&times;</span>
    <div class="modal-content">
      {% for image in exppost.image_set.all %}
        <img class="mySlides" src="{{ image.img.url }}" alt="{{ image.title }}">
        <p class="caption">Test</p>
      {% endfor %}

      {% if exppost.image_set.all|length > 1 %}
        <a class="prev" onclick="plusSlides(-1)">&#10094;</a>
        <a class="next" onclick="plusSlides(1)">&#10095;</a>
      {% endif %}
    </div>
  </div>

  <script src="{% static 'pages/js/lightbox.js' %}?{% now "U" %}"></script>

  <!-- Journals -->
  <div id="journal">
    {% if exppost.journal_set.all %}
      <h2 class="heading">Journal</h2>
      {% for journal in exppost.journal_set.all|dictsortreversed:'pub_date' %}
        <p>
          <em class="journaltitle">{{ journal.title }}</em>
          <span class="date">{{ journal.pub_date|date:"F d, Y" }}</span>

          {{ journal.text|linebreaks }}
          <hr class="divide">
        </p>
      {% endfor %}
    {% endif %}
  </div>
{% endblock %}
